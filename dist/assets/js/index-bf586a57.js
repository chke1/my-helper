import{M as b}from"./message-box-4866a89d.js";import{E as h}from"./main/chunk-element-plus-b8cc1db0.js";import{r as P,$ as T}from"./main/chunk-vue-32374f64.js";function x({api:l,params:m={},lazy:p=!0,callBack:g}={}){if(!l)return;const a=P({paging:{page:1,size:30,total:60},loading:!1,tableData:[],initParams:{},searchParams:m}),n=async()=>{var o,r;a.loading=!0;let s={...a.paging,...a.initParams,...a.searchParams},t=await l(s).catch(e=>e);if(a.loading=!1,(t==null?void 0:t.code)===0){if(g){let e=g(t);e&&(t=e)}return a.tableData=((o=t.data)==null?void 0:o.data)||[],a.paging.total=(r=t.data)==null?void 0:r.total,t}},f=()=>{a.paging.page=1,n()},u=({api:s,params:t={},options:o={},callBack:r}={})=>{s&&b({title:"确定删除该数据？",message:"操作不可逆，请谨慎操作",...o,beforeClose:async(e,c,d)=>{if(e==="confirm"){c.confirmButtonLoading=!0;let i=await s(t).catch(D=>D);if(c.confirmButtonLoading=!1,(i==null?void 0:i.code)!==0)return;if(a.paging.page>1&&a.tableData.length==1&&a.paging.page--,r){r(i);return}h.success("删除成功"),n()}d()}})};return p&&f(),{...T(a),queryTableData:n,initTableData:f,delTableRow:u}}export{x as u};
