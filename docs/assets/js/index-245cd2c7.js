import{_ as F,y as k,a7 as S,a8 as j,a9 as D}from"./index-027c1f63.js";import{a as y,r as I,c as f,n as P,ag as g,aq as A,v,P as B,Q as h,y as i,W as b,U as E,x as _,F as w,V as x,T as M,R as N,a8 as R}from"./main/chunk-vue-32374f64.js";import"./main/chunk-element-plus-b8cc1db0.js";import"./main/chunk-lodash-es-21c98b27.js";import"./main/chunk-vue-router-c3f0a4ff.js";import"./main/chunk-fingerprintjs-cb838e3e.js";import"./main/chunk-sortablejs-be94e56d.js";const z=r=>new Promise((s,l)=>{const e=document.createElement("script");e.src=r,e.onload=()=>{e.remove(),s()},e.onerror=()=>{e.remove(),l(new Error(`Failed to load script: ${r}`))},document.head.appendChild(e)}),L=(r,s)=>new Promise((l,e)=>{var t=null,o=new XMLHttpRequest;o.open("GET",r),o.responseType="blob",o.onload=()=>{t=o.response;let a=new File([t],s,{type:t.type});l(a)},o.onerror=a=>{e(a)},o.onloadend=a=>{},o.onloadstart=a=>{},o.onprogress=a=>{},o.onreadystatechange=a=>{},o.send()}),q=r=>{const s=(l,e)=>new Promise((t,o)=>{const a=new FileReader;a.onload=p=>{p.target.error&&o(p.target.error),t(new Uint8Array(p.target.result))},a.readAsArrayBuffer(r.slice(e,e+l))});return new Promise(async(l,e)=>{const t=()=>r.size;let a=await(await window.MediaInfo().catch(e)).analyzeData(t,s).catch(e);l(a)})},G=async r=>{let s=Object.prototype.toString.call(r);if(!["[object File]","[object String]"].includes(s))return;await z("https://unpkg.com/mediainfo.js@0.2.1/dist/umd/index.min.js").then(()=>{});let e="";return s=="[object String]"&&(e=await L(r,Date.now()).catch(o=>o)),s=="[object File]"&&(e=r),await q(e).catch(o=>o)};const O={class:"video-fps"},W={class:"video-fps-left"},$={style:{"margin-bottom":"10px"}},H={class:"video-fps-right"},J=["src"],Q={class:"video-info"},X={class:"video-info-title"},K=["textContent"],Y={__name:"index",setup(r){const s={General:"视频封装格式信息",Video:"视频编码相关信息",Audio:"音频编码相关信息"},l=y(),e=y({uploadType:1,videoUrl:"",uploadVideo:{name:"",url:""},videoCover:[]}),t=I({loading:!1,fps:0,data:[]}),o=y([{formType:"title",label:"配置信息"},{formType:"select",prop:"uploadType",label:"上传类型:",optionList:[{label:"本地选择",value:1},{label:"视频链接",value:2}],optionProps:{label:"label",value:"value"},onChange:n=>{}},{layout:"flex",tips:"网络视频加载时间较长，不建议加载",children:[{formType:"input",prop:"videoUrl",label:"视频链接:",style:{width:"200px"},isShow:f(()=>e.value.uploadType==2)},{formType:"button",label:"",buttonText:"加载视频",labelWidth:"10px",isShow:f(()=>e.value.uploadType==2),disabled:f(()=>!e.value.videoUrl),onClick:()=>a(e.value.videoUrl,e.value.videoUrl)}]},{formType:"upload-file",prop:"uploadVideo",label:"本地上传:",desc:!1,multiple:!1,isShow:f(()=>e.value.uploadType==1),onEnd:n=>{const c=k(n.file);a(c,n.file),P(()=>{S(l.value,d=>{t.fps=d})})}},{formType:"slot",slot:"videoCoverSlot",prop:"videoCover",ratio:"5:4",label:"封面:",desc:!1}]),a=async(n,c)=>{var m;t.loading=!0,e.value.uploadVideo.temporarilyUrl=n;let d=await G(c);t.data=((m=d==null?void 0:d.media)==null?void 0:m.track)||[],t.loading=!1},p=()=>{if(!l.value)return;let n=D(l.value);e.value.videoCover.push({imageUrl:n})};return(n,c)=>{const d=g("el-button"),m=g("c-form"),C=g("c-card"),U=A("loading");return v(),B(C,{isAffix:""},{default:h(()=>{var T,V;return[i("div",O,[i("div",W,[b(m,{"label-width":"100px",model:e.value,rows:o.value,isFooter:!1},{videoCoverSlot:h(()=>[i("div",$,[b(d,{onClick:p},{default:h(()=>[E("捕获当前帧画面")]),_:1})]),b(j,{modelValue:e.value.videoCover,"onUpdate:modelValue":c[0]||(c[0]=u=>e.value.videoCover=u),desc:!1},null,8,["modelValue"])]),_:1},8,["model","rows"])]),i("div",H,[(T=e.value.uploadVideo)!=null&&T.temporarilyUrl?(v(),_(w,{key:0},[i("video",{ref_key:"myVideo",ref:l,class:"video-ele",autoplay:"",controls:"",src:(V=e.value.uploadVideo)==null?void 0:V.temporarilyUrl},null,8,J),i("div",null,"视频帧率："+x(t.fps)+" fps",1)],64)):M("",!0),N((v(),_("div",Q,[(v(!0),_(w,null,R(t.data,u=>(v(),_(w,{key:u},[i("p",X,x(s[u["@type"]]),1),i("pre",{class:"video-info-pre",textContent:x(JSON.stringify(u,null,2))},null,8,K)],64))),128))])),[[U,t.loading]])])])]}),_:1})}}},se=F(Y,[["__scopeId","data-v-bb43353f"]]);export{se as default};
